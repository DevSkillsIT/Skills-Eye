# ============================================================================
# PROMETHEUS.YML - SERVIDOR PRINCIPAL PALMAS (172.16.1.26)
# ============================================================================
# Vers√£o: 3.0 - OTIMIZADO E DOCUMENTADO
# √öltima atualiza√ß√£o: 2025-01-30
# Fun√ß√£o: Coletor MASTER - recebe remote_write e coleta via Consul SD
# ----------------------------------------------------------------------------
# MOTIVOS DAS MUDAN√áAS E NOTAS DE ARQUITETURA (IMPORTANTE LER)
# - üö´ Anchors no topo do arquivo (ex.: .relabel_*) geravam erro de "campo
#   desconhecido" no Prometheus. Corre√ß√£o: mover a defini√ß√£o dos anchors
#   para o PRIMEIRO job que os utiliza (ex.: &relabel_blackbox no Job 2 e
#   &relabel_exporter no Job 9). Assim, o YAML continua DRY e v√°lido.
# - ‚úÖ Evitamos injetar uma *lista dentro de outra lista* em relabel_configs
#   (que causava "cannot unmarshal !!seq into relabel"). Em jobs remotos,
#   colamos a sequ√™ncia inline e adicionamos __address__ no final.
# - üîê Seguran√ßa: mantivemos basic_auth com password_file e documentamos
#   permiss√µes. Token do Consul est√° expl√≠cito neste arquivo para facilitar
#   valida√ß√£o em laborat√≥rio ‚Äî ROTACIONAR em produ√ß√£o e preferir vari√°vel
#   de ambiente/arquivo separado com permiss√µes restritas.
# - üß≠ Topologia: Palmas √© MASTER, recebe remote_write do Rio e faz Consul SD.
#   Rio tem blackbox local desativado (comentado) para evitar duplicidade; 
#   Palmas j√° consulta via jobs remotos.
# ============================================================================

# ============================================================================
# CONFIGURA√á√ÉO GLOBAL
# ============================================================================
global:
  # Intervalo de coleta padr√£o para todos os jobs (pode ser sobrescrito por job)
  scrape_interval: 30s
  
  # Intervalo de avalia√ß√£o de regras de alerta
  evaluation_interval: 45s
  
  # Timeout padr√£o de scrape (10s √© seguro para maioria dos casos)
  scrape_timeout: 10s
  
  # Labels externos aplicados a TODAS as m√©tricas deste Prometheus
  # √ötil para identificar origem quando usar federation ou remote_write
  external_labels:
    cluster: 'palmas-master'
    datacenter: 'skillsit-palmas-to'
    prometheus_instance: '172.16.1.26'
    environment: 'production'
    site: 'palmas'

# ============================================================================
# CONFIGURA√á√ÉO DE STORAGE E RETEN√á√ÉO
# ============================================================================
# NOTA: Estas configs v√£o no arquivo prometheus.service ou na linha de comando
# Inclu√≠das aqui apenas para documenta√ß√£o
#
# --storage.tsdb.path=/var/lib/prometheus/data
# --storage.tsdb.retention.time=120d  # Reten√ß√£o: 120 dias
# --storage.tsdb.retention.size=150GB # Limite: 150GB (ajuste conforme disco)
# --web.enable-lifecycle               # Permite reload via HTTP POST
# --web.enable-admin-api              # Habilita API admin
# --web.config.file=/etc/prometheus/web-config.yml  # Auth bcrypt
#
# ‚ö†Ô∏è Dica: garanta I/O suficiente para o TSDB (disco SSD) e monitore
# compactions/time series churn para ajustar reten√ß√£o e limites.
# ============================================================================

# ============================================================================
# ALERTMANAGER
# ============================================================================
alerting:
  alertmanagers:
    - static_configs:
        - targets:
            - localhost:9093
      # Timeout para tipo_monitoramentoio de alertas
      timeout: 10s

# ============================================================================
# ARQUIVOS DE REGRAS DE ALERTA
# ============================================================================
rule_files:
  - "rules_monit_alerts_prometheus.yml"      # Regras Blackbox/Ping/SSL (v√°lide com promtool)
  - "rules_monit_alerts_nodes_lin.yml"       # Regras Linux (Node Exporter)
  - "rules_monit_alerts_windows.yml"         # Regras Windows (Windows Exporter)
  - "rules_monit_alerts_global.yml"          # Regras gen√©ricas de monitoramento

# ============================================================================
# REMOTE WRITE ENDPOINT (RECEBE DADOS DO RIO)
# ============================================================================
# NOTA: O endpoint /api/v1/write est√° HABILITADO por padr√£o no Prometheus.
# Rio (172.16.200.14) tipo_monitoramentoia dados para c√° usando remote_write.
# N√ÉO precisa configura√ß√£o adicional aqui ‚Äî se√ß√£o mantida por documenta√ß√£o.
# ============================================================================

# ============================================================================
# ANCHOR YAML - RELABEL CONFIGS (DRY - DON'T REPEAT YOURSELF)
# ============================================================================
# Observa√ß√£o: anchors agora s√£o definidos ONDE S√ÉO USADOS pela primeira vez
# (ex.: &relabel_blackbox no Job 2 e &relabel_exporter no Job 9). Isso mant√©m
# o YAML v√°lido e evita chaves desconhecidas no root.
# ============================================================================

# ============================================================================
# SCRAPE CONFIGS - JOBS DE COLETA
# ============================================================================
scrape_configs:

  # ========================================================================
  # JOB 1: PROMETHEUS (SELF-MONITORING)
  # ========================================================================
  # Monitora o pr√≥prio Prometheus + Blackbox Exporter local
  # üîê Seguran√ßa: certifique-se de que /etc/prometheus/.prometheus
  #   exista, com conte√∫do gerado por htpasswd/openssl e permiss√µes seguras.
  #   Sugest√£o: chown root:prometheus; chmod 0640.
  # ========================================================================
  - job_name: 'prometheus'
    basic_auth:
      username: prometheus
      password_file: /etc/prometheus/.prometheus
    scrape_interval: 30s
    static_configs:
      - targets:
          - 'localhost:9090'   # Prometheus
          - 'localhost:9115'   # Blackbox Exporter

  # ========================================================================
  # JOB 2-8: BLACKBOX EXPORTER - MONITORAMENTO ATIVO (ICMP/HTTP/HTTPS/TCP)
  # ========================================================================
  # Usa Consul SD para descobrir targets automaticamente por TAG (module).
  # Abaixo definimos &relabel_blackbox UMA √öNICA VEZ e reutilizamos com alias.
  # ========================================================================

  # ------------------------------------------------------------------------
  # JOB 2: HTTP 2xx (Sites/APIs que devem retornar 200-303)
  # ------------------------------------------------------------------------
  - job_name: 'http_2xx'
    metrics_path: /probe
    params:
      module: [http_2xx]
    consul_sd_configs:
      - server: '172.16.1.26:8500'
        token: '8382a112-81e0-cd6d-2b92-8565925a0675'  # ‚ö†Ô∏è ROTACIONAR EM PRODU√á√ÉO
        services: ['blackbox_exporter']
        tags: ['http_2xx']
    relabel_configs: &relabel_blackbox
      - source_labels: [__meta_consul_service]
        target_label: cservice
      - source_labels: [__meta_consul_service_metadata_vendor]
        target_label: vendor
      - source_labels: [__meta_consul_service_metadata_region]
        target_label: region
      - source_labels: [__meta_consul_service_metadata_account]
        target_label: account
      # CR√çTICO: instance do Consul vira __param_target para o Blackbox
      - source_labels: [__meta_consul_service_metadata_instance]
        target_label: __param_target
      # Labels de neg√≥cio (16 campos)
      - source_labels: [__meta_consul_service_metadata_company]
        target_label: company
      - source_labels: [__meta_consul_service_metadata_tipo_monitoramento]
        target_label: tipo_monitoramento
      - source_labels: [__meta_consul_service_metadata_name]
        target_label: name
      - source_labels: [__meta_consul_service_metadata_grupo_monitoramento]
        target_label: grupo_monitoramento
      - source_labels: [__meta_consul_service_metadata_localizacao]
        target_label: localizacao
      - source_labels: [__meta_consul_service_metadata_fabricante]
        target_label: fabricante
      - source_labels: [__meta_consul_service_metadata_tipo]
        target_label: tipo
      - source_labels: [__meta_consul_service_metadata_modelo]
        target_label: modelo
      - source_labels: [__meta_consul_service_metadata_cod_localidade]
        target_label: cod_localidade
      - source_labels: [__meta_consul_service_metadata_tipo_dispositivo_abrev]
        target_label: tipo_dispositivo_abrev
      - source_labels: [__meta_consul_service_metadata_cidade]
        target_label: cidade
      - source_labels: [__meta_consul_service_metadata_notas]
        target_label: notas
      - source_labels: [__meta_consul_service_metadata_glpi_url]
        target_label: glpi_URL
      - source_labels: [__meta_consul_service_metadata_provedor]
        target_label: provedor
      # Target final vira instance (ex: http://site.com, 192.168.1.1)
      - source_labels: [__param_target]
        target_label: instance
      # Endere√ßo do Blackbox Exporter (substitui __address__ do Consul)
      - source_labels: [__meta_consul_service_metadata_campoextra1]
        target_label: campoextra1
      - source_labels: [__meta_consul_service_metadata_campoextra2]
        target_label: campoextra2
      - target_label: __address__
        replacement: 127.0.0.1:9115

  # ------------------------------------------------------------------------
  # JOB 3: HTTP 4xx (P√°ginas que devem retornar erro 400-404)
  # ------------------------------------------------------------------------
  - job_name: 'http_4xx'
    metrics_path: /probe
    params:
      module: [http_4xx]
    consul_sd_configs:
      - server: '172.16.1.26:8500'
        token: '8382a112-81e0-cd6d-2b92-8565925a0675'
        services: ['blackbox_exporter']
        tags: ['http_4xx']
    relabel_configs: *relabel_blackbox

  # ------------------------------------------------------------------------
  # JOB 4: HTTPS (Sites seguros com valida√ß√£o de certificado)
  # ------------------------------------------------------------------------
  - job_name: 'https'
    metrics_path: /probe
    params:
      module: [https]
    consul_sd_configs:
      - server: '172.16.1.26:8500'
        token: '8382a112-81e0-cd6d-2b92-8565925a0675'
        services: ['blackbox_exporter']
        tags: ['https']
    relabel_configs: *relabel_blackbox

  # ------------------------------------------------------------------------
  # JOB 5: HTTP POST (APIs que usam m√©todo POST)
  # ------------------------------------------------------------------------
  - job_name: 'http_post_2xx'
    metrics_path: /probe
    params:
      module: [http_post_2xx]
    consul_sd_configs:
      - server: '172.16.1.26:8500'
        token: '8382a112-81e0-cd6d-2b92-8565925a0675'
        services: ['blackbox_exporter']
        tags: ['http_post_2xx']
    relabel_configs: *relabel_blackbox

  # ------------------------------------------------------------------------
  # JOB 6: SSH Banner (Verifica se SSH est√° respondendo)
  # ------------------------------------------------------------------------
  - job_name: 'ssh_banner'
    metrics_path: /probe
    params:
      module: [ssh_banner]
    consul_sd_configs:
      - server: '172.16.1.26:8500'
        token: '8382a112-81e0-cd6d-2b92-8565925a0675'
        services: ['blackbox_exporter']
        tags: ['ssh_banner']
    relabel_configs: *relabel_blackbox

  # ------------------------------------------------------------------------
  # JOB 7: TCP Connect (Testa conectividade TCP gen√©rica)
  # ------------------------------------------------------------------------
  - job_name: 'tcp_connect'
    metrics_path: /probe
    params:
      module: [tcp_connect]
    consul_sd_configs:
      - server: '172.16.1.26:8500'
        token: '8382a112-81e0-cd6d-2b92-8565925a0675'
        services: ['blackbox_exporter']
        tags: ['tcp_connect']
    relabel_configs: *relabel_blackbox

  # ------------------------------------------------------------------------
  # JOB 8: ICMP (Ping - Monitoramento de conectividade)
  # ------------------------------------------------------------------------
  - job_name: 'icmp'
    scrape_interval: 30s
    scrape_timeout: 10s
    metrics_path: /probe
    params:
      module: [icmp]
    consul_sd_configs:
      - server: '172.16.1.26:8500'
        token: '8382a112-81e0-cd6d-2b92-8565925a0675'
        services: ['blackbox_exporter']
        tags: ['icmp']
    relabel_configs: *relabel_blackbox

  # ========================================================================
  # JOB 9-10: NODE/WINDOWS EXPORTER - M√âTRICAS DE SISTEMA
  # ========================================================================
  # Coleta m√©tricas de CPU, RAM, Disco, Rede dos servidores.
  # Definimos &relabel_exporter aqui e reutilizamos no job Windows.
  # ========================================================================

  # ------------------------------------------------------------------------
  # JOB 9: Node Exporter (Servidores Linux)
  # ------------------------------------------------------------------------
  - job_name: node_exporter
    basic_auth:
      username: prometheus
      password_file: /etc/prometheus/.prometheus
    scrape_interval: 60s
    scrape_timeout: 10s
    consul_sd_configs:
      - server: '172.16.1.26:8500'
        token: '8382a112-81e0-cd6d-2b92-8565925a0675'
        refresh_interval: 45s
        services: ['selfnode_exporter']
        tags: ['linux']
    # Template para Node/Windows Exporter via Consul
    relabel_configs: &relabel_exporter
      - source_labels: [__meta_consul_service]
        target_label: cservice
      - source_labels: [__meta_consul_service_metadata_vendor]
        target_label: vendor
      - source_labels: [__meta_consul_service_metadata_region]
        target_label: region
      - source_labels: [__meta_consul_service_metadata_account]
        target_label: account
      - source_labels: [__meta_consul_service_metadata_instance]
        target_label: instance
      - source_labels: [__meta_consul_service_metadata_company]
        target_label: company
      - source_labels: [__meta_consul_service_metadata_tipo_monitoramento]
        target_label: tipo_monitoramento
      - source_labels: [__meta_consul_service_metadata_name]
        target_label: name
      - source_labels: [__meta_consul_service_metadata_grupo_monitoramento]
        target_label: grupo_monitoramento
      - source_labels: [__meta_consul_service_metadata_localizacao]
        target_label: localizacao
      - source_labels: [__meta_consul_service_metadata_fabricante]
        target_label: fabricante
      - source_labels: [__meta_consul_service_metadata_tipo]
        target_label: tipo
      - source_labels: [__meta_consul_service_metadata_modelo]
        target_label: modelo
      - source_labels: [__meta_consul_service_metadata_cod_localidade]
        target_label: cod_localidade
      - source_labels: [__meta_consul_service_metadata_tipo_dispositivo_abrev]
        target_label: tipo_dispositivo_abrev
      - source_labels: [__meta_consul_service_metadata_cidade]
        target_label: cidade
      - source_labels: [__meta_consul_service_metadata_notas]
        target_label: notas
      - source_labels: [__meta_consul_service_metadata_glpi_url]
        target_label: glpi_URL
      - source_labels: [__meta_consul_service_metadata_provedor]
        target_label: provedor
      - source_labels: [__meta_consul_service_metadata_campoextra1]
        target_label: campoextra1
      - source_labels: [__meta_consul_service_metadata_campoextra2]
        target_label: campoextra2
      # Para exporters, instance DO CONSUL vira __address__ diretamente
      - source_labels: [instance]
        target_label: __address__

  # ------------------------------------------------------------------------
  # JOB 10: Windows Exporter (Servidores Windows)
  # ------------------------------------------------------------------------
  - job_name: windows_exporter
  #  basic_auth:
  #    username: prometheus
  #    password_file: /etc/prometheus/.prometheus
    scrape_interval: 60s
    scrape_timeout: 10s
    consul_sd_configs:
      - server: '172.16.1.26:8500'
        token: '8382a112-81e0-cd6d-2b92-8565925a0675'
        refresh_interval: 45s
        services: ['selfnode_exporter']
        tags: ['windows']
    relabel_configs: *relabel_exporter

  # ========================================================================
  # JOB 11: MIKROTIK (via MKTXP Exporter)
  # ========================================================================
  - job_name: 'mktxp'
    scrape_interval: 60s
    scrape_timeout: 60s
    static_configs:
      - targets:
          - 'localhost:49090'
        labels:
          tipo_monitoramento: 'production'
    # Observa√ß√£o: ajuste o scrape_timeout conforme lat√™ncia/dispositivos.

  # ========================================================================
  # JOB 12: SNMP EXPORTER
  # ========================================================================
  - job_name: snmp
    metrics_path: /snmp
    params:
      module: [if_mib]
    static_configs:
      - targets:
          - '127.0.0.1'
    relabel_configs:
      - source_labels: [__address__]
        target_label: __param_target
      - source_labels: [__param_target]
        target_label: instance
      - target_label: __address__
        replacement: '127.0.0.1:9116'
    # Notas: confirme que o snmp_exporter est√° em 127.0.0.1:9116 e que
    # o snmp.yml inclui o m√≥dulo if_mib para seus dispositivos.

  # ========================================================================
  # JOB 13-14: BLACKBOX EXPORTER REMOTO - ICMP VIA N√ìS SECUND√ÅRIOS
  # ========================================================================
  # Palmas coleta m√©tricas de ping executados NOS n√≥s remotos, diminuindo a
  # interfer√™ncia de lat√™ncia entre Palmas e os targets. Em cada job remoto,
  # __address__ aponta para o blackbox exporter do N√ì remoto.
  # ========================================================================

  # ------------------------------------------------------------------------
  # JOB 13: ICMP via RMD-LDC Rio (172.16.200.14) - Cliente Ramada
  # ------------------------------------------------------------------------
  #- job_name: 'icmp_blackbox_remote_rmd_ldc'
  #  scrape_interval: 20s
  #  scrape_timeout: 4s
  ##  metrics_path: /probe
  #  params:
  #    module: [icmp]
  #  consul_sd_configs:
  #    - server: '172.16.200.14:8500'
  #      token: '8382a112-81e0-cd6d-2b92-8565925a0675'
  #      services: ['blackbox_remote_rmd_ldc']
  #      tags: ['icmp']
  #  relabel_configs:
  #    # Template para Blackbox Exporter REMOTO (s√≥ muda o __address__ final)
  #    # Usado para jobs: icmp_blackbox_remote_rmd_ldc e icmp_blackbox_remote_dtc_skills
  #    # .relabel_blackbox_remote: &relabel_blackbox_remote  (mantido como documenta√ß√£o)
  #    - source_labels: [__meta_consul_service]
  #      target_label: cservice
  #    - source_labels: [__meta_consul_service_metadata_vendor]
  #      target_label: vendor
  #    - source_labels: [__meta_consul_service_metadata_region]
  #      target_label: region
  #    - source_labels: [__meta_consul_service_metadata_account]
  #      target_label: account
   #   - source_labels: [__meta_consul_service_metadata_instance]
   #     target_label: __param_target
   #   - source_labels: [__meta_consul_service_metadata_company]
   #     target_label: company
   #   - source_labels: [__meta_consul_service_metadata_tipo_monitoramento]
   #     target_label: tipo_monitoramento
   #   - source_labels: [__meta_consul_service_metadata_name]
   #     target_label: name
   #   - source_labels: [__meta_consul_service_metadata_grupo_monitoramento]
   #     target_label: grupo_monitoramento
   ##   - source_labels: [__meta_consul_service_metadata_localizacao]
   #     target_label: localizacao
   #   - source_labels: [__meta_consul_service_metadata_fabricante]
   #     target_label: fabricante
   #   - source_labels: [__meta_consul_service_metadata_tipo]
   #     target_label: tipo
   #   - source_labels: [__meta_consul_service_metadata_modelo]
   #     target_label: modelo
   #   - source_labels: [__meta_consul_service_metadata_cod_localidade]
   #     target_label: cod_localidade
   #   - source_labels: [__meta_consul_service_metadata_tipo_dispositivo_abrev]
   #     target_label: tipo_dispositivo_abrev
   #   - source_labels: [__meta_consul_service_metadata_cidade]
   #     target_label: cidade
   #   - source_labels: [__meta_consul_service_metadata_notas]
   #     target_label: notas
   #   - source_labels: [__meta_consul_service_metadata_glpi_url]
   #     target_label: glpi_URL
   ##   - source_labels: [__meta_consul_service_metadata_provedor]
   #     target_label: provedor
   ###   - source_labels: [__param_target]
   ##     target_label: instance
   #   - source_labels: [__meta_consul_service_metadata_campoextra1]
   #     target_label: campoextra1
   #   - source_labels: [__meta_consul_service_metadata_campoextra2]
   #     target_label: campoextra2
      # NOTA: __address__ ser√° definido em cada job espec√≠fico
    #  - target_label: __address__
    #    replacement: '172.16.200.14:9115'

  # ------------------------------------------------------------------------
  # JOB 14: ICMP via DTC-Genesis (11.144.0.21)
  # ------------------------------------------------------------------------
#  - job_name: 'icmp_blackbox_remote_dtc_skills'
 #   scrape_interval: 20s
 #   scrape_timeout: 4s
 #   metrics_path: /probe
 #   params:
 #     module: [icmp]
 #   consul_sd_configs:
 #     - server: '11.144.0.21:8500'
 #       token: '8382a112-81e0-cd6d-2b92-8565925a0675'
 #       services: ['blackbox_remote_dtc_skills']
 #       tags: ['icmp']
 #   relabel_configs:
 #     # Usa o mesmo template l√≥gico do job anterior; apenas __address__ muda.
 #     - source_labels: [__meta_consul_service]
 #       target_label: cservice
 #     - source_labels: [__meta_consul_service_metadata_vendor]
 #       target_label: vendor
 #     - source_labels: [__meta_consul_service_metadata_region]
 #       target_label: region
 #     - source_labels: [__meta_consul_service_metadata_account]
 #       target_label: account
 #     - source_labels: [__meta_consul_service_metadata_instance]
 #       target_label: __param_target
 #     - source_labels: [__meta_consul_service_metadata_company]
 #       target_label: company
 #     - source_labels: [__meta_consul_service_metadata_tipo_monitoramento]
 #       target_label: tipo_monitoramento
 #     - source_labels: [__meta_consul_service_metadata_name]
 #       target_label: name
 #     - source_labels: [__meta_consul_service_metadata_grupo_monitoramento]
 #       target_label: grupo_monitoramento
 #     - source_labels: [__meta_consul_service_metadata_localizacao]
 ##       target_label: localizacao
 #     - source_labels: [__meta_consul_service_metadata_fabricante]
 #       target_label: fabricante
 #     - source_labels: [__meta_consul_service_metadata_tipo]
 ##       target_label: tipo
 #     - source_labels: [__meta_consul_service_metadata_modelo]
 #       target_label: modelo
 #     - source_labels: [__meta_consul_service_metadata_cod_localidade]
 #       target_label: cod_localidade
 #     - source_labels: [__meta_consul_service_metadata_tipo_dispositivo_abrev]
 #       target_label: tipo_dispositivo_abrev
 #     - source_labels: [__meta_consul_service_metadata_cidade]
 #       target_label: cidade
 #     - source_labels: [__meta_consul_service_metadata_notas]
 #       target_label: notas
 #     - source_labels: [__meta_consul_service_metadata_glpi_url]
 #       target_label: glpi_URL
 #     - source_labels: [__meta_consul_service_metadata_provedor]
 #       target_label: provedor
 #     - source_labels: [__param_target]
 #       target_label: instance
 #     - source_labels: [__meta_consul_service_metadata_campoextra1]
 #       target_label: campoextra1
 #     - source_labels: [__meta_consul_service_metadata_campoextra2]
 #       target_label: campoextra2
      # NOTA: __address__ ser√° definido em cada job espec√≠fico
 #     - target_label: __address__
 #       replacement: '11.144.0.21:9115'


# ============================================================================
# VALIDA√á√ÉO PR√â-DEPLOYMENT
# ============================================================================
# Execute antes de aplicar:
#
# 1. Validar sintaxe:
#    promtool check config /etc/prometheus/prometheus.yml
#
# 2. Validar regras:
#    promtool check rules /etc/prometheus/*.yml
#
# 3. Testar Consul SD:
#    curl -H "X-Consul-Token: 8382a112-81e0-cd6d-2b92-8565925a0675" \
#      http://172.16.1.26:8500/v1/catalog/services | jq
#
# 4. Backup:
#    cp /etc/prometheus/prometheus.yml /etc/prometheus/prometheus.yml.bkp_$(date +%Y%m%d_%H%M%S)
#
# 5. Aplicar:
#    systemctl reload prometheus
#
# 6. Verificar targets:
#    curl -u prometheus:'Promet@2025#Sk' http://localhost:9090/api/v1/targets | jq
#    # Dica: use state=any para ver todos: /api/v1/targets?state=any
#
# 7. Monitorar logs:
#    journalctl -u prometheus -f
#
# 8. Seguran√ßa (p√≥s):
#    - Rotacionar token do Consul ap√≥s valida√ß√µes.
#    - Confirmar permiss√µes dos arquivos de senha (0640) e owner/grupo corretos.
# ============================================================================
