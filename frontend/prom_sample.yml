# Prometheus Rio - 172.16.200.14 (padrão Palmas)
global:
  scrape_interval: 30s
  evaluation_interval: 45s

remote_write:
  - url: "http://172.16.1.26:9090/api/v1/write"
    basic_auth:
      username: prometheus
      password: Skills@2021,TI
    queue_config:
      capacity: 5000
      max_samples_per_send: 500
      batch_send_deadline: 5s
      min_backoff: 30s
      max_backoff: 5m

alerting:
  alertmanagers:
  - static_configs:
    - targets:
       - localhost:9093

rule_files:
   - "prometheus_rules.yml"
   - "node_rules_alerts.yml"
   - "win_alert_rules.yml"

scrape_configs:
  - job_name: node_exporter_rio
    basic_auth:
      username: prometheus
      password: Skills@2021,TI
    scrape_interval: 60s
    scrape_timeout: 10s
    consul_sd_configs:
      - server: 'localhost:8500'
        token: '8382a112-81e0-cd6d-2b92-8565925a0675'
        refresh_interval: 45s
        services: ['selfnode_exporter_rio']
        tags: ['linux']
    relabel_configs:
      - source_labels: ['__meta_consul_service']
        target_label: cservice
      - source_labels: ['__meta_consul_service_metadata_vendor']
        target_label: vendor
      - source_labels: ['__meta_consul_service_metadata_region']
        target_label: region
      - source_labels: ['__meta_consul_service_metadata_group']
        target_label: group
      - source_labels: ['__meta_consul_service_metadata_account']
        target_label: account
      - source_labels: ['__meta_consul_service_metadata_name']
        target_label: name
      - source_labels: ['__meta_consul_service_metadata_iid']
        target_label: iid
      - source_labels: ['__meta_consul_service_metadata_exp']
        target_label: exp
      - source_labels: ['__meta_consul_service_metadata_instance']
        target_label: instance
      - source_labels: ['__meta_consul_service_metadata_company']
        target_label: company
      - source_labels: ['__meta_consul_service_metadata_env']
        target_label: env
      - source_labels: ['__meta_consul_service_metadata_project']
        target_label: project
      - source_labels: ['__meta_consul_service_metadata_localizacao']
        target_label: localizacao
      - source_labels: ['__meta_consul_service_metadata_fabricante']
        target_label: fabricante
      - source_labels: ['__meta_consul_service_metadata_tipo']
        target_label: tipo
      - source_labels: ['__meta_consul_service_metadata_modelo']
        target_label: modelo
      - source_labels: ['__meta_consul_service_metadata_cod_localidade']
        target_label: cod_localidade
      - source_labels: ['__meta_consul_service_metadata_tipo_dispositivo_abrev']
        target_label: tipo_dispositivo_abrev
      - source_labels: ['__meta_consul_service_metadata_cidade']
        target_label: cidade
      - source_labels: ['__meta_consul_service_metadata_notas']
        target_label: notas
      - source_labels: ['__meta_consul_service_metadata_glpi_url']
        target_label: glpi_URL
      - source_labels: [instance]
        target_label: __address__
  - job_name: windows_exporter_rio
    relabel_configs:
      - source_labels: ['__meta_consul_service_metadata_glpi_url']
        target_label: glpi_URL
      - source_labels: [instance]
        target_label: __address__
